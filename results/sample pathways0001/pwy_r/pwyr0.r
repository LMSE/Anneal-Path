if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("hyperdraw")
BiocManager::install("hypergraph")
#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$#
#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$#
library(hypergraph)
library(hyperdraw)

DHE0000 <- DirectedHyperedge(c("Serine"), c("Pyruvate"), "EC4.3.1_0")
DHE0001 <- DirectedHyperedge(c("Aldehyde","Glycine"), c("Serine"), "EC4.1.2_0")
DHE0002 <- DirectedHyperedge(c("D-Fructose 6-phosphate"), c("Aldehyde","6-Phospho-2-dehydro-D-gluconate"), "EC4.1.2_1")
DHE0003 <- DirectedHyperedge(c("Glyoxylate"), c("Glycine"), "EC1.4.1_0")
DHE0004 <- DirectedHyperedge(c("beta-D-Fructose 6-phosphate"), c("D-Fructose 6-phosphate"), "EC1.1.1_0")
DHE0005 <- DirectedHyperedge(c("D-Allose 6-phosphate"), c("Glyoxylate","D-Xylose-5-phosphate"), "EC4.1.2_2")
DHE0006 <- DirectedHyperedge(c("D-Glucose 6-phosphate"), c("D-Allose 6-phosphate"), "EC1.1.1_1")
DHE0007 <- DirectedHyperedge(c("D-Glucose 6-phosphate"), c("beta-D-Fructose 6-phosphate"), "EC5.3.1_0")
DHE0008 <- DirectedHyperedge(c("Glycolaldehyde"), c("Aldehyde","Glyoxylate"), "EC4.1.2_3")
DHE0009 <- DirectedHyperedge(c("D-Allose 6-phosphate"), c("D-Threose 4-phosphate","Glycolaldehyde"), "EC4.1.2_4")
DHE0010 <- DirectedHyperedge(c("D-Threose 4-phosphate"), c("Aldehyde","Glyceraldehyde 3-phosphate"), "EC4.1.2_5")
DHE0011 <- DirectedHyperedge(c("D-Fructose 6-phosphate"), c("Aldehyde","D-Xylose-5-phosphate"), "EC4.1.2_6")
DHE0012 <- DirectedHyperedge(c("D-Xylose-5-phosphate"), c("Aldehyde","D-Threose 4-phosphate"), "EC4.1.2_7")
DHE0013 <- DirectedHyperedge(c("D-Allose 6-phosphate"), c("Aldehyde","D-Xylose-5-phosphate"), "EC4.1.2_8")
DHE0014 <- DirectedHyperedge(c("Glycolaldehyde"), c("Aldehyde"), "EC4.1.2_9")
DHE0015 <- DirectedHyperedge(c("Glyoxylate"), c("Aldehyde"), "EC4.1.2_10")
DHE0016 <- DirectedHyperedge(c("Hydroxypyruvate"), c("Serine"), "EC1.4.1_1")
DHE0017 <- DirectedHyperedge(c("Glycolaldehyde"), c("Hydroxypyruvate"), "EC4.1.2_11")
DHE0018 <- DirectedHyperedge(c("D-Fructose 6-phosphate"), c("Hydroxypyruvate","D-Threose 4-phosphate"), "EC4.1.2_12")
DHE0019 <- DirectedHyperedge(c("Aldehyde","Glyoxylate"), c("Hydroxypyruvate"), "EC4.1.2_13")
DHE0020 <- DirectedHyperedge(c("Ethanolamine"), c("Serine"), "EC4.1.2_14")
DHE0021 <- DirectedHyperedge(c("Glycolaldehyde"), c("Ethanolamine"), "EC1.4.1_2")
DHE0022 <- DirectedHyperedge(c("Acetaldehyde"), c("Pyruvate"), "EC4.1.2_15")
DHE0023 <- DirectedHyperedge(c("Ethanolamine"), c("Acetaldehyde"), "EC4.3.1_1")
DHE0024 <- DirectedHyperedge(c("D-Threose 4-phosphate"), c("Glyoxylate","Glyceraldehyde 3-phosphate"), "EC4.1.2_16")
DHE0025 <- DirectedHyperedge(c("D-Xylose-5-phosphate"), c("Glyoxylate","D-Threose 4-phosphate"), "EC4.1.2_17")
DHE0026 <- DirectedHyperedge(c("Aldehyde","Glyoxylate"), c("Glycolaldehyde"), "EC4.1.2_18")
DHE0027 <- DirectedHyperedge(c("D-Xylose-5-phosphate"), c("Glyceraldehyde 3-phosphate","Glycolaldehyde"), "EC4.1.2_19")
DHE0028 <- DirectedHyperedge(c("D-Fructose 6-phosphate"), c("D-Threose 4-phosphate","Glycolaldehyde"), "EC4.1.2_20")
DHE0029 <- DirectedHyperedge(c("threo-3-Hydroxy-L-aspartate"), c("Serine"), "EC4.1.1_0")
DHE0030 <- DirectedHyperedge(c("2-Hydroxy-3-oxosuccinate"), c("threo-3-Hydroxy-L-aspartate"), "EC1.4.1_3")
DHE0031 <- DirectedHyperedge(c("Glyoxylate"), c("2-Hydroxy-3-oxosuccinate"), "EC4.1.2_21")
DHE0032 <- DirectedHyperedge(c("Glycine","Glyoxylate"), c("threo-3-Hydroxy-L-aspartate"), "EC4.1.2_22")
DHE0033 <- DirectedHyperedge(c("Aldehyde"), c("Glyoxylate"), "EC4.1.2_23")
DHE0034 <- DirectedHyperedge(c("2-Hydroxy-3-oxosuccinate"), c("Hydroxypyruvate"), "EC4.1.2_24")
DHE0035 <- DirectedHyperedge(c("Aldehyde"), c("Glycolaldehyde"), "EC4.1.2_25")
DHE0036 <- DirectedHyperedge(c("Aldehyde","Oxomalonate"), c("Hydroxypyruvate"), "EC4.1.2_26")
DHE0037 <- DirectedHyperedge(c("Glyoxylate"), c("Oxomalonate"), "EC4.1.2_27")
DHE0038 <- DirectedHyperedge(c("Aldehyde","Methylamine"), c("Ethanolamine"), "EC4.1.2_28")
DHE0039 <- DirectedHyperedge(c("Aldehyde"), c("Methylamine"), "EC1.4.1_4")
DHE0040 <- DirectedHyperedge(c("Oxaloacetate"), c("Pyruvate"), "EC4.1.2_29")
DHE0041 <- DirectedHyperedge(c("threo-3-Hydroxy-L-aspartate"), c("Oxaloacetate"), "EC4.3.1_2")
Cnodes <- c("Serine","Pyruvate","Aldehyde","Glycine","D-Fructose 6-phosphate","6-Phospho-2-dehydro-D-gluconate","Glyoxylate","beta-D-Fructose 6-phosphate","D-Allose 6-phosphate","D-Xylose-5-phosphate","D-Glucose 6-phosphate","Glycolaldehyde","D-Threose 4-phosphate","Glyceraldehyde 3-phosphate","Hydroxypyruvate","Ethanolamine","Acetaldehyde","threo-3-Hydroxy-L-aspartate","2-Hydroxy-3-oxosuccinate","Oxomalonate","Methylamine","Oxaloacetate")
Rnodes <- list(DHE0000,DHE0001,DHE0002,DHE0003,DHE0004,DHE0005,DHE0006,DHE0007,DHE0008,DHE0009,DHE0010,DHE0011,DHE0012,DHE0013,DHE0014,DHE0015,DHE0016,DHE0017,DHE0018,DHE0019,DHE0020,DHE0021,DHE0022,DHE0023,DHE0024,DHE0025,DHE0026,DHE0027,DHE0028,DHE0029,DHE0030,DHE0031,DHE0032,DHE0033,DHE0034,DHE0035,DHE0036,DHE0037,DHE0038,DHE0039,DHE0040,DHE0041)
hg <- Hypergraph(Cnodes,Rnodes)
hgbph <- graphBPH(hg)
testrabph <- graphLayout(hgbph)
edgeDataDefaults(testrabph, "lwd") <- 1
edgeDataDefaults(testrabph, "color") <- "black"
nodeDataDefaults(testrabph, "margin") <- 'unit(1, "mm")'
nodeDataDefaults(testrabph, "shape") <- "box"
nodeDataDefaults(testrabph, "color") <- "black"
#plot(testrabph)
initial.options <- commandArgs(trailingOnly = FALSE)
file.arg.name <- "--file="
script.name <- sub(file.arg.name, "", initial.options[grep(file.arg.name, initial.options)])
script.basename <- dirname(script.name)
other.name <- file.path(script.basename, "")
save_path<-paste(other.name,"/pathways/pathway","0.png",sep="")
png(file = save_path, width = 3840, height = 2160, res = 300)
plot(testrabph)
dev.off()

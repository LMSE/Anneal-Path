if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("hyperdraw")
BiocManager::install("hypergraph")
#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$#
#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$#
library(hypergraph)
library(hyperdraw)

DHE0000 <- DirectedHyperedge(c("O=CC(O)C(O)C(O)C(O)CO"), c("D-Glucose"), "EC1.1.1_0")
DHE0001 <- DirectedHyperedge(c("Aldehyde","D-Xylose"), c("O=CC(O)C(O)C(O)C(O)CO"), "EC4.1.2_0")
DHE0002 <- DirectedHyperedge(c("Glyceraldehyde","Glycolaldehyde"), c("D-Xylose"), "EC4.1.2_1")
DHE0003 <- DirectedHyperedge(c("Hydroxypyruvate"), c("Aldehyde","Glyoxylate"), "EC4.1.2_2")
DHE0004 <- DirectedHyperedge(c("Glyoxylate","Glycolaldehyde"), c("Glyceraldehyde"), "EC4.1.2_3")
DHE0005 <- DirectedHyperedge(c("O=C(CO)OP(=O)(O)O"), c("Glycolaldehyde"), "EC1.2.1_0")
DHE0006 <- DirectedHyperedge(c("Glycolaldehyde"), c("Hydroxypyruvate"), "EC4.1.2_4")
DHE0007 <- DirectedHyperedge(c("Glycolate"), c("O=C(CO)OP(=O)(O)O"), "EC2.7.1_0")
DHE0008 <- DirectedHyperedge(c("Glycolate"), c("Glycolaldehyde"), "EC1.2.1_1")
DHE0009 <- DirectedHyperedge(c("Glycolate"), c("Glyoxylate"), "EC1.1.1_1")
DHE0010 <- DirectedHyperedge(c("Glyoxylate","D-Threose"), c("D-Xylose"), "EC4.1.2_5")
DHE0011 <- DirectedHyperedge(c("Glycolaldehyde"), c("Aldehyde"), "EC4.1.2_6")
DHE0012 <- DirectedHyperedge(c("Glycolaldehyde"), c("Aldehyde","Glyoxylate"), "EC4.1.2_7")
DHE0013 <- DirectedHyperedge(c("Glycolaldehyde"), c("D-Threose"), "EC4.1.2_8")
DHE0014 <- DirectedHyperedge(c("D-Threose","Glycolaldehyde"), c("O=CC(O)C(O)C(O)C(O)CO"), "EC4.1.2_9")
DHE0015 <- DirectedHyperedge(c("Aldehyde"), c("Glycolaldehyde"), "EC4.1.2_10")
DHE0016 <- DirectedHyperedge(c("Glyoxylate","Glyceraldehyde"), c("D-Threose"), "EC4.1.2_11")
DHE0017 <- DirectedHyperedge(c("NC(=O)CO"), c("Aldehyde","Formamide"), "EC4.1.2_12")
DHE0018 <- DirectedHyperedge(c("Glycolate"), c("NC(=O)CO"), "EC3.5.1_0")
DHE0019 <- DirectedHyperedge(c("Aldehyde","D-Threose"), c("D-Xylose"), "EC4.1.2_13")
DHE0020 <- DirectedHyperedge(c("3-Dehydro-L-threonate"), c("Aldehyde","2-Hydroxy-3-oxosuccinate"), "EC4.1.2_14")
DHE0021 <- DirectedHyperedge(c("Glyoxylate","Glycolaldehyde"), c("3-Dehydro-L-threonate"), "EC4.1.2_15")
DHE0022 <- DirectedHyperedge(c("3-Dehydro-L-threonate"), c("Aldehyde","2-Hydroxy-3-oxopropanoate"), "EC4.1.2_16")
DHE0023 <- DirectedHyperedge(c("Hydroxypyruvate"), c("Aldehyde","Oxomalonate"), "EC4.1.2_17")
DHE0024 <- DirectedHyperedge(c("D-Threose"), c("Aldehyde","Glyceraldehyde"), "EC4.1.2_18")
DHE0025 <- DirectedHyperedge(c("Glyoxylate","D-Xylose"), c("O=CC(O)C(O)C(O)C(O)CO"), "EC4.1.2_19")
DHE0026 <- DirectedHyperedge(c("Aldehyde","Glyoxylate"), c("Glycolaldehyde"), "EC4.1.2_20")
DHE0027 <- DirectedHyperedge(c("2-Hydroxy-3-oxosuccinate"), c("Glyoxylate","Oxomalonate"), "EC4.1.2_21")
DHE0028 <- DirectedHyperedge(c("Glyoxylate"), c("2-Hydroxy-3-oxosuccinate"), "EC4.1.2_22")
DHE0029 <- DirectedHyperedge(c("Glyceraldehyde"), c("Aldehyde","Glycolaldehyde"), "EC4.1.2_23")
DHE0030 <- DirectedHyperedge(c("2-Hydroxy-3-oxopropanoate"), c("Glyoxylate","Aldehyde"), "EC4.1.2_24")
DHE0031 <- DirectedHyperedge(c("Glyoxylate"), c("2-Hydroxy-3-oxopropanoate"), "EC4.1.2_25")
DHE0032 <- DirectedHyperedge(c("2-Hydroxy-3-oxopropanoate"), c("Glyoxylate"), "EC4.1.2_26")
DHE0033 <- DirectedHyperedge(c("Glycolaldehyde"), c("2-Hydroxy-3-oxopropanoate"), "EC4.1.2_27")
DHE0034 <- DirectedHyperedge(c("2-Oxoaldehyde"), c("Glycolaldehyde"), "EC1.1.1_2")
DHE0035 <- DirectedHyperedge(c("Glyoxylate"), c("2-Oxoaldehyde"), "EC1.2.1_2")
DHE0036 <- DirectedHyperedge(c("D-Erythrulose"), c("Aldehyde","Glyceraldehyde"), "EC4.1.2_28")
DHE0037 <- DirectedHyperedge(c("Glycolaldehyde"), c("D-Erythrulose"), "EC4.1.2_29")
DHE0038 <- DirectedHyperedge(c("Aldehyde","Glyceraldehyde"), c("D-Threose"), "EC4.1.2_30")
DHE0039 <- DirectedHyperedge(c("D-Erythrulose"), c("Glycolaldehyde","Hydroxypyruvate"), "EC4.1.2_31")
DHE0040 <- DirectedHyperedge(c("Aldehyde"), c("Glyoxylate"), "EC4.1.2_32")
DHE0041 <- DirectedHyperedge(c("Glyoxylate"), c("Aldehyde"), "EC4.1.2_33")
DHE0042 <- DirectedHyperedge(c("2-Hydroxy-3-oxopropanoate"), c("HCO3-","Glycolaldehyde"), "EC6.4.1_0")
DHE0043 <- DirectedHyperedge(c("Ethanolamine"), c("Aldehyde","Methylamine"), "EC4.1.2_34")
DHE0044 <- DirectedHyperedge(c("Glycolaldehyde"), c("Ethanolamine"), "EC1.4.1_0")
DHE0045 <- DirectedHyperedge(c("3-Dehydro-L-threonate"), c("Glyoxylate","Hydroxypyruvate"), "EC4.1.2_35")
DHE0046 <- DirectedHyperedge(c("Oxomalonate"), c("Glyoxylate","HCO3-"), "EC6.4.1_1")
DHE0047 <- DirectedHyperedge(c("Glyoxylate"), c("Oxomalonate"), "EC4.1.2_36")
DHE0048 <- DirectedHyperedge(c("O=C(CO)C(O)(O)CO"), c("Aldehyde","O=C(O)C(=O)C(O)(O)CO"), "EC4.1.2_37")
DHE0049 <- DirectedHyperedge(c("Glycolaldehyde","Glycolate"), c("O=C(CO)C(O)(O)CO"), "EC4.1.2_38")
DHE0050 <- DirectedHyperedge(c("D-Threose"), c("Glyoxylate","Glyceraldehyde"), "EC4.1.2_39")
DHE0051 <- DirectedHyperedge(c("2-Hydroxy-3-oxopropanoate"), c("Glycolaldehyde"), "EC4.1.1_0")
DHE0052 <- DirectedHyperedge(c("D-Fructose"), c("D-Glucose"), "EC5.3.1_0")
DHE0053 <- DirectedHyperedge(c("D-Psicose"), c("D-Fructose"), "EC1.1.1_3")
DHE0054 <- DirectedHyperedge(c("D-Threose","Glycolaldehyde"), c("D-Psicose"), "EC4.1.2_40")
DHE0055 <- DirectedHyperedge(c("Erythritol","OCC(O)C(O)(O)CO"), c("D-Fructose"), "EC4.2.2_0")
DHE0056 <- DirectedHyperedge(c("O=C(CO)C(O)(O)CO"), c("OCC(O)C(O)(O)CO"), "EC1.1.1_4")
DHE0057 <- DirectedHyperedge(c("D-Threose"), c("Erythritol"), "EC1.1.1_5")
DHE0058 <- DirectedHyperedge(c("D-Erythrulose"), c("Aldehyde","O=C(O)C(=O)C(O)CO"), "EC4.1.2_41")
DHE0059 <- DirectedHyperedge(c("D-Erythrulose"), c("Erythritol"), "EC1.1.1_6")
DHE0060 <- DirectedHyperedge(c("O=C(CO)C(O)(O)CO"), c("Aldehyde","O=C(CO)C(O)O"), "EC4.1.2_42")
DHE0061 <- DirectedHyperedge(c("2-Oxoaldehyde"), c("Glyoxylate"), "EC1.2.1_3")
DHE0062 <- DirectedHyperedge(c("Glycolaldehyde"), c("2-Oxoaldehyde"), "EC1.1.1_7")
DHE0063 <- DirectedHyperedge(c("O=C(CO)C(O)(O)CO"), c("Aldehyde","O=CC(O)(O)CO"), "EC4.1.2_43")
DHE0064 <- DirectedHyperedge(c("D-Erythrulose"), c("Aldehyde","Glycerone"), "EC4.1.2_44")
DHE0065 <- DirectedHyperedge(c("D-Threose","Hydroxypyruvate"), c("D-Psicose"), "EC4.1.2_45")
Cnodes <- c("O=CC(O)C(O)C(O)C(O)CO","D-Glucose","Aldehyde","D-Xylose","Glyceraldehyde","Glycolaldehyde","Hydroxypyruvate","Glyoxylate","O=C(CO)OP(=O)(O)O","Glycolate","D-Threose","NC(=O)CO","Formamide","3-Dehydro-L-threonate","2-Hydroxy-3-oxosuccinate","2-Hydroxy-3-oxopropanoate","Oxomalonate","2-Oxoaldehyde","D-Erythrulose","HCO3-","Ethanolamine","Methylamine","O=C(CO)C(O)(O)CO","O=C(O)C(=O)C(O)(O)CO","D-Fructose","D-Psicose","Erythritol","OCC(O)C(O)(O)CO","O=C(O)C(=O)C(O)CO","O=C(CO)C(O)O","O=CC(O)(O)CO","Glycerone")
Rnodes <- list(DHE0000,DHE0001,DHE0002,DHE0003,DHE0004,DHE0005,DHE0006,DHE0007,DHE0008,DHE0009,DHE0010,DHE0011,DHE0012,DHE0013,DHE0014,DHE0015,DHE0016,DHE0017,DHE0018,DHE0019,DHE0020,DHE0021,DHE0022,DHE0023,DHE0024,DHE0025,DHE0026,DHE0027,DHE0028,DHE0029,DHE0030,DHE0031,DHE0032,DHE0033,DHE0034,DHE0035,DHE0036,DHE0037,DHE0038,DHE0039,DHE0040,DHE0041,DHE0042,DHE0043,DHE0044,DHE0045,DHE0046,DHE0047,DHE0048,DHE0049,DHE0050,DHE0051,DHE0052,DHE0053,DHE0054,DHE0055,DHE0056,DHE0057,DHE0058,DHE0059,DHE0060,DHE0061,DHE0062,DHE0063,DHE0064,DHE0065)
hg <- Hypergraph(Cnodes,Rnodes)
hgbph <- graphBPH(hg)
testrabph <- graphLayout(hgbph)
edgeDataDefaults(testrabph, "lwd") <- 1
edgeDataDefaults(testrabph, "color") <- "black"
nodeDataDefaults(testrabph, "margin") <- 'unit(1, "mm")'
nodeDataDefaults(testrabph, "shape") <- "box"
nodeDataDefaults(testrabph, "color") <- "black"
#plot(testrabph)
initial.options <- commandArgs(trailingOnly = FALSE)
file.arg.name <- "--file="
script.name <- sub(file.arg.name, "", initial.options[grep(file.arg.name, initial.options)])
script.basename <- dirname(script.name)
other.name <- file.path(script.basename, "")
save_path<-paste(other.name,"/pathways/pathway","0.png",sep="")
png(file = save_path, width = 3840, height = 2160, res = 300)
plot(testrabph)
dev.off()
